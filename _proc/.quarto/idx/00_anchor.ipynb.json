{"title":"Generate anchor boxes","markdown":{"yaml":{"description":"Methods to generate anchor boxes of different aspect ratios.","output-file":"anchor.html","title":"Generate anchor boxes"},"headingText":"Ground truth anchor boxes","containsRefs":false,"markdown":"\n\n\n\n<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->\n\nTo generate anchor boxes, we need three basic information:\n\n- Input image size, `image_sz`: To position our anchor boxes within the maximum \ncoordinates (`width`, `height`) of the image.\n- Feature map size, `feature_sz`: Feature map is the size (`width`, `height`) \nof the output of a convolutional operation. A $10\\times10$ feature map would mean \n$10\\times10$ local receptive field locations can be traced back into the \ninput image. These 100 receptive field locations ($10\\times10=100$) in the input image \nwould act as our initial anchor box candidates.\n\n![](https://ars.els-cdn.com/content/image/1-s2.0-S0925231217314169-gr4.jpg)\n\n- Aspect ratio of anchor boxes, `asp_ratio`: To generate anchor boxes with \ndifferent `width` to `height` ratio (default `asp_ratio=1`).\n\nUsually multiple anchor boxes with different `feature_sz` and `asp_ratio` are \nneeded. This requirement arises in the case of multiscale object detection.\n\nFor multiscale object detection, feature maps from different convolution \noperations of the network are used to trace back into the input image, to \ngenerate anchor boxes. \nThe [`bxs`](https://thatgeeman.github.io/pybx/anchor.html#bxs) method of `pybx` provides this possibility.\n\nAll methods work with asymetric `image_sz` (and or `feature_szs` as well):\n\nGround truth boxes are anchor boxes with maximum IOU with the true annotations.\n\nLoad actual annotations.\n\nConvert to MultiBx for convenience:\n\nGenerate anchor boxes for object detection task, given that we know: \n\n```py\nimage_sz = (256, 256)  # to know the upper bounds of candidate bounding boxes\nfeature_sz = [20, 10, 8, 3]\nasp_ratio = [1, 0.5, 0.3]\n```\n\nStore coords as multibx for convenience.\n\nCan use the true annotations and anchor boxes to calulate the IOU.\n\nThe question: for each true label in the provided true annotations, what are the possible ground truth anchor boxes?\n\nImprove the loop to return only those with good IOU:\n\nNot very far from the original annotations. These scales and aspect ratios can also be read from the label. \nThe finer the anchor boxes, the better the starting positions (ground truth anchor boxes).\n\nIf anchor box labels are passed, they can be preserved instead of overwriting with ground truth labels.\n\nTrue annots can also be a list containing the label as the last item.\n\nMethod to also return just the max IOU ground truth boxes.\n\nCan also use methods for the box to calculate properties or convert to different box formats.\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"anchor.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.184","theme":"cosmo","description":"Methods to generate anchor boxes of different aspect ratios.","title":"Generate anchor boxes"},"extensions":{"book":{"multiFile":true}}}}}